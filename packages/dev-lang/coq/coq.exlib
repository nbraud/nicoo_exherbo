# Copyright 2012 Nicolas Braud-Santoni <nicolas@braud-santoni.eu>
# Distributed under the terms of the GNU General Public License v2

HOMEPAGE="http://coq.inria.fr/"
SUMMARY="A proof assistant"
DESCRIPTION="
Coq is a formal proof management system.
It provides a formal language to write mathematical definitions, executable
 algorithms and theorems together with an environment for semi-interactive
development of machine-checked proofs.
"

LICENCES="LGPL-2.1"
SLOT="0"
MYOPTIONS="
    gtk
    ocamlopt
"

DEPENDENCIES="
    build+run:
      dev-lang/ocaml[ocamlopt?]
      gtk? ( dev-ocaml/lablgtk )
"

coq_src_configure() {
    local CONFIG
    CONFIG="--prefix /usr --libdir /usr/${LIBDIR} "

    option gtk && CONFIG+="--lablgtkdir /usr/${LIBDIR}/ocaml/lablgtk2/ " || CONFIG+="--coqide no "

    option ocamlopt && CONFIG+="--opt "

    edo ./configure ${CONFIG}
}

coq_src_install() {
    emake COQINSTALLPREFIX="${IMAGE}" install
    edo rmdir "${IMAGE}/usr/${LIBDIR}/user-contrib"
}


export_exlib_phases src_configure src_install

